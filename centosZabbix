#!/bin/bash
sudo bash -c 'echo net.ipv6.conf.default.disable_ipv6=1 >> /etc/sysctl.conf'
sudo bash -c 'echo net.ipv6.conf.all.disable_ipv6=1 >> /etc/sysctl.conf'
sudo bash -c 'sysctl -p'
sudo bash -c 'rpm -Uvh https://repo.zabbix.com/zabbix/4.4/rhel/7/x86_64/zabbix-release-4.4-1.el7.noarch.rpm'
sudo bash -c 'yum install zabbix-agent -y'
sudo bash -c 'echo PidFile=/var/run/zabbix/zabbix_agentd.pid > /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo LogFile=/var/log/zabbix/zabbix_agentd.log >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo LogFileSize=0 >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo Server=200.166.152.114 >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo ServerActive=200.166.152.114 >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo Hostname=$HOSTNAME >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'echo Include=/etc/zabbix/zabbix_agentd.d/*.conf >> /etc/zabbix/zabbix_agentd.conf'
sudo bash -c 'systemctl enable zabbix-agent'
sudo bash -c 'systemctl start zabbix-agent'
sudo bash -c 'echo SELINUX=disabled > /etc/selinux/config'
sudo bash -c 'echo SELINUXTYPE=targeted >> /etc/selinux/config'
sudo bash -c 'systemctl reboot'
